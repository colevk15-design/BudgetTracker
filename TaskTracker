<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>âœ… Weekly Habit Tracker</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
body { font-family:'Poppins',sans-serif; margin:0; padding:0; background:#f4f6f8; color:#333; transition:0.3s;}
body.dark { background:#1e1e2f; color:#f0f0f0;}
header { display:flex; justify-content:space-between; align-items:center; padding:20px; background:#007bff; color:white;}
body.dark header { background:#0056b3;}
header h1 { margin:0;}
button { padding:6px 12px; border:none; border-radius:6px; cursor:pointer; transition:0.3s;}
button:hover { opacity:0.8;}
input, select { padding:5px; border-radius:4px; border:1px solid #ccc; margin-right:4px;}
body.dark input, body.dark select { background:#333; color:#f0f0f0; border:1px solid #555;}
table { width:100%; border-collapse:collapse; margin-top:20px;}
th,td { padding:10px; border:1px solid #ccc; text-align:center;}
body.dark table, body.dark th, body.dark td { border:1px solid #555;}
th { background:#007bff; color:white;}
body.dark th { background:#0056b3;}
.completed { background:#c6f6c6;}
.not-completed { background:#f8d7da;}
.remove-btn { background:#ff4d4d; color:white; border:none; border-radius:5px; padding:4px 8px; margin-left:8px; cursor:pointer;}
.remove-btn:hover { background:#e60000;}
</style>
</head>
<body>

<header>
  <h1>âœ… Weekly Habit Tracker</h1>
  <button onclick="toggleDarkMode()">ðŸŒ™ Dark/Light Mode</button>
</header>

<div style="padding:20px;">
  <h2>Add Item</h2>
  <input type="text" id="itemInput" placeholder="New task or habit">
  <select id="itemType">
    <option value="Task">Task</option>
    <option value="Habit">Habit</option>
  </select>
  <button onclick="addItem()">âž• Add</button>

  <h2>Weekly Progress</h2>
  <table id="weeklyTable">
    <thead>
      <tr>
        <th>Item</th>
        <th>Type</th>
        <th>Mon</th>
        <th>Tue</th>
        <th>Wed</th>
        <th>Thu</th>
        <th>Fri</th>
        <th>Sat</th>
        <th>Sun</th>
        <th>Remove</th>
      </tr>
    </thead>
    <tbody id="weeklyBody"></tbody>
  </table>
</div>

<script>
// --- Dark Mode ---
function toggleDarkMode(){ 
  document.body.classList.toggle('dark'); 
  localStorage.setItem('darkMode', document.body.classList.contains('dark')); 
}
if(localStorage.getItem('darkMode') === 'true') document.body.classList.add('dark');

// --- Data ---
let items = JSON.parse(localStorage.getItem('weeklyItems')||'[]');
let lastSavedWeek = localStorage.getItem('lastSavedWeek');

// --- Weekly Reset ---
function getWeekNumber(d){
  d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
  const dayNum = d.getUTCDay() || 7;
  d.setUTCDate(d.getUTCDate() + 4 - dayNum);
  const yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
  return Math.ceil((((d - yearStart) / 86400000) + 1)/7);
}
const currentWeek = getWeekNumber(new Date());
if(lastSavedWeek != currentWeek){
  items.forEach(i=> i.days = [false,false,false,false,false,false,false]); // reset all days
  localStorage.setItem('lastSavedWeek', currentWeek);
  localStorage.setItem('weeklyItems', JSON.stringify(items));
}

// --- Build Table ---
function buildTable(){
  const tbody = document.getElementById('weeklyBody');
  tbody.innerHTML = '';
  items.forEach((item,index)=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${item.name}</td>
      <td>${item.type}</td>
      ${item.days.map((done,dayIndex)=>`
        <td>
          <input type="checkbox" ${done?'checked':''} onchange="toggleDay(${index},${dayIndex})">
        </td>`).join('')}
      <td><button class="remove-btn" onclick="removeItem(${index})">âœ–</button></td>
    `;
    tbody.appendChild(tr);
  });
}

// --- Add Item ---
function addItem(){
  const name = document.getElementById('itemInput').value.trim();
  const type = document.getElementById('itemType').value;
  if(!name) return;
  items.push({name,type,days:[false,false,false,false,false,false,false]});
  document.getElementById('itemInput').value='';
  saveData(); buildTable();
}

// --- Toggle Day ---
function toggleDay(index,dayIndex){
  items[index].days[dayIndex] = !items[index].days[dayIndex];
  saveData();
}

// --- Remove Item ---
function removeItem(index){
  items.splice(index,1);
  saveData(); buildTable();
}

// --- Save ---
function saveData(){
  localStorage.setItem('weeklyItems', JSON.stringify(items));
  localStorage.setItem('lastSavedWeek', currentWeek);
}

// --- Init ---
buildTable();
</script>

</body>
</html>
